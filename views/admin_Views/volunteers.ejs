<!-- Example Table of Volunteers -->
<!-- Single search bar -->
<div class="search-container">
  <input 
    type="text" 
    id="searchBox" 
    placeholder="Search" 
    oninput="liveSearch(this.value)">
</div>

<div id="searchResults"></div>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Sewing Level</th>
      <th>Hours Willing</th>
    </tr>
  </thead>
  <tbody>
    <% if (typeof volunteers !== 'undefined' && volunteers && volunteers.length > 0) { %>
      <% volunteers.forEach(function(volunteer) { %>
        <tr>
          <td><%= volunteer.first_name %> <%= volunteer.last_name %></td>
          <td><%= volunteer.email %></td>
          <td><%= volunteer.level_description || 'Not Set' %></td>
          <td><%= volunteer.hours_willing || 'Not Set' %></td>
        </tr>
      <% }); %>
    <% } else { %>
      <tr>
        <td colspan="4">No volunteers found</td>
      </tr>
    <% } %>
  </tbody>
</table>

<script>
async function liveSearch(query) {
  if (!query) {
    document.getElementById('searchResults').innerHTML = '';
    return;
  }

  try {
    const response = await fetch(`/searchVolunteers?query=${query}`);
    const results = await response.json();
    displayResults(results);
  } catch (error) {
    console.error("Error fetching search results:", error);
  }
}

function displayResults(results) {
  const resultsContainer = document.getElementById('searchResults');
  if (results.length > 0) {
    const rows = results.map(volunteer => `
      <tr>
        <td>${volunteer.first_name} ${volunteer.last_name}</td>
        <td>${volunteer.email}</td>
        <td>${volunteer.level_description || 'Not Set'}</td>
        <td>${volunteer.hours_willing || 'Not Set'}</td>
      </tr>
    `).join('');
    
    resultsContainer.innerHTML = `
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Sewing Level</th>
            <th>Hours Willing</th>
          </tr>
        </thead>
        <tbody>${rows}</tbody>
      </table>`;
  } else {
    resultsContainer.innerHTML = '<p>No matching volunteers found.</p>';
  }
}
</script>