<!-- Example Table of Users -->
<div class="search-container">
  <div class="search-container">
    <input 
      type="text" 
      class="search-input" 
      id="searchBox" 
      placeholder="Search" 
      oninput="liveSearch(this.value)">
  </div>
  
  <div id="searchResults"></div>
    
</div>
<script>
  // Search function triggered by input in the search box
async function liveSearch(query) {
  if (!query) {
    // If there's no query, reset the table to show all rows
    const allRows = document.querySelectorAll('#mainTable .editable-row');
    allRows.forEach(row => row.style.display = '');  // Show all rows
    console.log("No query, showing all rows");
    return;
  }

  // Convert the query to lower case for case-insensitive comparison
  const queryLower = query.toLowerCase();
  
  // Get all the rows in the main table
  const rows = document.querySelectorAll('#mainTable .editable-row');
  console.log(`Searching for: ${queryLower}`);

  rows.forEach(row => {
    const firstName = row.getAttribute('data-first-name').toLowerCase(); // Get first name
    const lastName = row.getAttribute('data-last-name').toLowerCase();   // Get last name

    // Check if the query matches the first or last name
    if (firstName.includes(queryLower) || lastName.includes(queryLower)) {
      row.style.display = '';  // Show matching row
    } else {
      row.style.display = 'none';  // Hide non-matching row
    }
  });
}


</script>

<table id="mainTable">
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
    </tr>
  </thead>
  <tbody>
    <% users.forEach(user => { %>
      <tr class="editable-row" 
          data-id="<%= user.contact_id %>" 
          data-email="<%= user.email %>"
          data-first-name="<%= user.first_name %>"
          data-last-name="<%= user.last_name %>"
          data-entity="user">
        <td><%= user.first_name + ' ' + user.last_name %></td>
        <td><%= user.email %></td>
        <td>
          <!-- You can remove the Edit button here, as the row itself is clickable -->
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>

<!-- Modal Template -->
<%- include('../components/modal', {
  title: 'Edit User',
  formAction: '/update-user',
  body: `
      <div class="input-field">
        <input id="entity-first-name" type="text" name="firstName" placeholder="First Name">
        <label for="entity-first-name"></label>
      </div>
      <div class="input-field">
        <input id="entity-last-name" type="text" name="lastName" placeholder="Last Name">
        <label for="entity-last-name"></label>
      </div>
      <div class="input-field">
        <input id="entity-email" type="email" name="email" placeholder="Email">
        <label for="entity-email"></label>
      </div>
  `
}) %>
